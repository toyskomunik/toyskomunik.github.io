!function(t){t.preLoad=function(n){function i(){u--,0===u&&o.resolve(s)}n="object"!=typeof n?[n]:n;for(var o=t.Deferred(),s=[],u=n.length,r=0;r<n.length;r++)s[r]=new Image,s[r].src=n[r],s[r].onload=i,s[r].onerror=i;return o.promise()},t.randomI=function(t,n){return Math.floor(Math.random()*(n-t)+t)},t.fn.bgChange=function(n,i){function o(n,i,o){var s=u.find(n);s.addClass(i).data("change",1).on("transitionend webkitTransitionEnd",function(){t(this).hasClass(i)&&t(this).removeClass(i).find(".child").css("background-image",'url("'+o+'")'),t(this).off("transitionend webkitTransitionEnd")})}function s(s,r){if(!D){D=!0,s=s||h[t.randomI(0,h.length)],r=r||c,u.find(".animation-item").css({transition:s.tDuration});do x=t.randomI(0,n.length);while(x===g);g=x;var e=n[x];s.init(),u.trigger("changeStart");var a=setInterval(function(){for(var t=1;t<=i.row;t++)for(var n=1;n<=i.col;n++)if(s.check(t,n)){var h=".item-"+t+"-"+n;1!=u.find(h).data("change")&&o(h,r,e)}s.next(),s.end()&&(clearInterval(a),u.find(".animation-item").data("change",0),setTimeout(function(){u.find(".animation-item").removeClass(s.duration),u.trigger("changeEnd"),D=!1},2e3))},s.sDuration)}}var u=this;t(u).css("position","relative"),n=[].concat(n);var r={row:7,col:9,scss:!0};i=t.extend(r,i);var h=[{tDuration:"1s",sDuration:"140",init:function(){this.num=2},check:function(t,n){return t+n==this.num},next:function(){this.num++},end:function(){return i.col+i.row+1==this.num}},{tDuration:"1s",sDuration:"140",init:function(){this.num=i.row-1},check:function(t,n){return t-n==this.num},next:function(){this.num--},end:function(){return 1-i.col-1==this.num}},{tDuration:"1s",sDuration:"140",init:function(){this.num=i.row+i.col},check:function(t,n){return t+n==this.num},next:function(){this.num--},end:function(){return-1==this.num}},{tDuration:"1s",sDuration:"140",init:function(){this.num=1-i.col},check:function(t,n){return t-n==this.num},next:function(){this.num++},end:function(){return i.row-1+1==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return t==this.num},next:function(){this.num++},end:function(){return i.row+1==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return n==this.num},next:function(){this.num++},end:function(){return i.col+1==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=i.row},check:function(t,n){return t==this.num},next:function(){this.num--},end:function(){return 0==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=i.col},check:function(t,n){return n==this.num},next:function(){this.num--},end:function(){return 0===this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return t==this.num||n==this.num},next:function(){this.num++},end:function(){return i.row>i.col?i.row==this.num:i.col==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return i.row-t+1==this.num||i.col-n+1==this.num},next:function(){this.num++},end:function(){return i.row>i.col?m==this.num:f==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return t==this.num||i.col-n+1==this.num},next:function(){this.num++},end:function(){return i.row>i.col?i.row==this.num:f==this.num}},{tDuration:"1.2s",sDuration:"200",init:function(){this.num=1},check:function(t,n){return i.row-t+1==this.num||n==this.num},next:function(){this.num++},end:function(){return i.row>i.col?m==this.num:i.col==this.num}},{tDuration:"1.4s",sDuration:"300",init:function(){this.num=1},check:function(t,n){return t==this.num||n==this.num||i.row-t+1==this.num||i.col-n+1==this.num},next:function(){this.num++},end:function(){return i.row>i.col?Math.floor(i.row/2)+1==this.num:Math.floor(i.col/2)+1==this.num}},{num:1,position:{},tDuration:"1.8s",sDuration:"320",init:function(){this.num=1,this.position.x=(i.row+1)/2,this.position.y=(i.col+1)/2},check:function(t,n){return Math.abs(t-this.position.x)+Math.abs(n-this.position.y)<this.num},next:function(){this.num++},end:function(){return this.num>this.position.x+this.position.y}},{num:0,start:i.row>i.col?"options.col":"options.row",tDuration:"1.6s",sDuration:"300",init:function(){this.num=i.row>i.col?Math.floor(i.col/2):Math.floor(i.row/2)},check:function(t,n){return"options.row"==this.start?t-this.num>=1&&t+this.num<i.row+1&&n-this.num>=1&&n+this.num<i.col+1:"options.col"==this.start?n-this.num>=1&&n+this.num<i.col+1&&t-this.num>=1&&t+this.num<i.row+1:void 0},next:function(){this.num--},end:function(){return this.num==-1}},{tDuration:".6s",sDuration:"50",direction:"row",init:function(){this.point=[[1,1],[1,i.col],[i.row,i.col],[i.row,1]],this.point[0]=[2,1],this.direction="row",this.positive=!0,this.iNow=1,this.jNow=1,this.allNum=i.col*i.row},check:function(t,n){return t==this.iNow&&n==this.jNow},next:function(){this.allNum--,"row"==this.direction&&this.jNow<this.point[1][1]&&this.positive?(this.jNow++,this.jNow==this.point[1][1]&&(this.point[1]=[this.point[1][0]+1,this.point[1][1]-1],this.direction="col",this.positive=!0)):"col"==this.direction&&this.iNow<this.point[2][0]&&this.positive?(this.iNow++,this.iNow==this.point[2][0]&&(this.point[2]=[this.point[2][0]-1,this.point[2][1]-1],this.direction="row",this.positive=!1)):"row"==this.direction&&this.jNow>this.point[3][1]&&!this.positive?(this.jNow--,this.jNow==this.point[3][1]&&(this.point[3]=[this.point[3][0]-1,this.point[3][1]+1],this.direction="col",this.positive=!1)):"col"==this.direction&&this.iNow>this.point[0][0]&&!this.positive&&(this.iNow--,this.iNow==this.point[0][0]&&(this.point[0]=[this.point[0][0]+1,this.point[0][1]+1],this.direction="row",this.positive=!0))},end:function(){return 0===this.allNum}}],c="start-change",e=t(u),a="";if(i.scss||7==i.row&&9==i.col)for(var m=1;m<=i.row;m++)for(var f=1;f<=i.col;f++)a+='<div class="animation-item item-'+m+"-"+f+'"><div class="child"></div></div>';else for(var l=1;l<=i.row;l++)for(var d=1;d<=i.col;d++){var w="animation-item item-"+l+"-"+d,p=["width:"+100/i.col+"%;","height:"+100/i.row+"%;","top:"+100/i.row*(l-1)+"%;","left:"+100/i.col*(d-1)+"%;"].join(""),v=["top:"+-100*(l-1)+"%;","left:"+-100*(d-1)+"%;","width:"+100*i.col+"%;","height:"+100*i.row+"%;"].join("");a+=['<div class="'+w+'" ','style="'+p+'"','><div class="child" ','style="'+v+'"',"></div></div>"].join("")}e.html(a);var D=!1,g=-1,x=-1;return{change:s,method:h,changeImages:function(t){n=t}}}}(jQuery);